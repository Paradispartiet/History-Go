<!doctype html>
<html lang="no">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>History Go</title>
  <meta name="theme-color" content="#0d1b2a" />
  <link rel="manifest" href="manifest.json" />

  <!-- Leaflet -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
  <script defer src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <!-- Styles -->
  <link rel="stylesheet" href="theme.css" />

  <!-- Icons (inline SVG helper) -->
  <script defer src="icons.js"></script>

  <!-- App -->
  <script defer src="app.js"></script>
</head>
<body>
  <!-- KART -->
  <div id="map" aria-label="Kart"></div>

  <!-- Kart-knapper (kun i kart-modus) -->
  <button id="btnExitMap"   class="map-exit"   aria-label="Tilbake" title="Tilbake">✕</button>
  <button id="btnCenter"    class="map-center" aria-label="Sentrer meg" title="Sentrer">◎</button>
  <button id="btnFilter"    class="map-filter" aria-label="Filter" title="Filter">☰</button>
  <button id="btnClearRoute" class="map-clear" aria-label="Fjern sti" title="Fjern sti">—</button>

  <!-- TOAST -->
  <div id="toast">OK</div>

  <!-- HEADER -->
  <header>
    <h1>History Go</h1>
    <div class="header-actions">
      <label class="test small">Testmodus <input id="testToggle" type="checkbox" /></label>
      <button id="btnSeeMap" class="link-btn">Se kart</button>
    </div>
  </header>

  <!-- INNHOLD -->
  <main>
    <div class="section">
      <div id="status" class="muted">Henter posisjon…</div>
    </div>

    <!-- Steder i nærheten (2) -->
    <section class="section">
      <div class="title underline underline-blue">Steder i nærheten</div>
      <div id="nearbyList"></div>
      <div class="row right">
        <button id="btnSeeMoreNearby" class="ghost-btn">Se flere i nærheten</button>
      </div>
    </section>

    <!-- Mine steder (ikoner + navn) -->
    <section class="section">
      <div class="title underline underline-gold">Mine steder (<span id="collectionCount">0</span>)</div>
      <div id="ownedPlacesGrid" class="icon-grid"></div>
      <div class="row right">
        <button id="btnMoreCollection" class="ghost-btn" style="display:none">+ flere</button>
      </div>
    </section>

    <!-- Mine personer (ikoner + navn, kun samlet) -->
    <section class="section">
      <div class="title underline underline-red">Mine personer</div>
      <div id="ownedPeopleGrid" class="icon-grid"></div>
    </section>

    <!-- Merker -->
    <section class="section">
      <div class="title underline underline-soft">Merker</div>
      <div id="merits" class="grid"></div>
    </section>
  </main>

  <!-- PLACE CARD -->
  <div id="placeCard" aria-hidden="true">
    <div class="pc-head">
      <div>
        <div id="pcTitle" class="pc-title">Tittel</div>
        <div id="pcMeta" class="pc-meta">Kategori • radius</div>
      </div>
      <button id="pcClose" class="pc-close" aria-label="Lukk">✕</button>
    </div>
    <div id="pcDesc" class="pc-desc">Beskrivelse…</div>
    <div class="pc-actions">
      <a id="pcMore" class="ghost-btn" target="_blank" rel="noopener">Mer info</a>
      <button id="pcUnlock" class="primary-btn">Lås opp</button>
      <button id="pcRoute"  class="link-btn">Vis rute</button>
    </div>
  </div>

  <!-- SHEET: Se flere i nærheten -->
  <div id="sheetNearby" class="sheet" aria-hidden="true">
    <div class="sheet-card">
      <div class="sheet-head">
        <div class="sheet-title">Flere i nærheten</div>
        <button data-close="#sheetNearby" class="sheet-close">✕</button>
      </div>
      <div id="sheetNearbyBody"></div>
    </div>
  </div>

  <!-- SHEET: Hele samlingen -->
  <div id="sheetCollection" class="sheet" aria-hidden="true">
    <div class="sheet-card">
      <div class="sheet-head">
        <div class="sheet-title">Samlingen din</div>
        <button data-close="#sheetCollection" class="sheet-close">✕</button>
      </div>
      <div id="sheetCollectionBody" class="grid"></div>
    </div>
  </div>

  <!-- SHEET: Filter -->
  <div id="sheetFilter" class="sheet" aria-hidden="true">
    <div class="sheet-card">
      <div class="sheet-head">
        <div class="sheet-title">Filter</div>
        <button data-close="#sheetFilter" class="sheet-close">✕</button>
      </div>
      <div id="filterBody" class="filter-body">
        <div class="filter-row">
          <label><input type="checkbox" class="flt-cat" value="Historie" checked/> Historie</label>
          <label><input type="checkbox" class="flt-cat" value="Kultur" checked/> Kultur</label>
          <label><input type="checkbox" class="flt-cat" value="Sport" checked/> Sport</label>
          <label><input type="checkbox" class="flt-cat" value="Natur" checked/> Natur</label>
          <label><input type="checkbox" class="flt-cat" value="Urban Life" checked/> Urban Life</label>
          <label><input type="checkbox" class="flt-cat" value="Vitenskap" checked/> Vitenskap</label>
        </div>
        <div class="filter-row">
          <label><input type="checkbox" id="fltPlaces" checked/> Vis steder</label>
          <label><input type="checkbox" id="fltPeople" checked/> Vis personer</label>
        </div>
      </div>
    </div>
  </div>

  <!-- QUIZ MODAL -->
  <div id="quizModal" aria-hidden="true" role="dialog" aria-label="Quiz">
    <div class="quiz-card">
      <div class="quiz-head">
        <div class="quiz-title" id="quizTitle">Quiz</div>
        <button class="quiz-close" id="quizClose" aria-label="Lukk">✕</button>
      </div>
      <div class="quiz-body">
        <div id="quizQuestion" class="quiz-q">…</div>
        <div id="quizChoices" class="quiz-choices"></div>
        <div id="quizProgress" class="quiz-progress"></div>
        <div id="quizFeedback" class="quiz-feedback"></div>
      </div>
    </div>
  </div>

  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('./sw.js').catch(()=>{});
    }
  </script>
</body>
</html>
