<!doctype html>
<html lang="no">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>History Go</title>
  <meta name="theme-color" content="#0d1b2a" />
  <link rel="manifest" href="manifest.json" />

  <!-- Leaflet -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script defer src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <!-- App styles -->
  <link rel="stylesheet" href="theme.css" />
</head>
<body>
  <!-- KART -->
  <div id="map" aria-label="Kart"></div>

  <!-- KART-KNAPPER (bare i kart-modus) -->
  <button id="btnExitMap" class="map-exit" aria-label="Tilbake">✕</button>
  <button id="btnCenter" class="map-center" aria-label="Sentrer">◎</button>

  <!-- TOAST -->
  <div id="toast" role="status">OK</div>

  <!-- HEADER -->
  <header>
    <div class="brand">
      <span class="logo">🏙️</span>
      <h1>History Go</h1>
    </div>
    <button id="btnSeeMap" class="pill-btn" aria-label="Se kart">
      <span class="ico">🗺️</span> Se kart
    </button>
  </header>

  <!-- INNHOLD (forside) -->
  <main>
    <div class="section row between">
      <div id="status" class="muted">Henter posisjon…</div>
      <label class="test small">Testmodus <input id="testToggle" type="checkbox" /></label>
    </div>

    <!-- STEDER I NÆRHETEN -->
    <section class="section panel">
      <div class="title underline underline-blue">
        <span class="ico">📍</span> Steder i nærheten
      </div>
      <div id="nearbyList"></div>
      <div class="row right">
        <button id="btnSeeMoreNearby" class="ghost-btn">Se flere i nærheten</button>
      </div>
    </section>

    <!-- PERSONER I NÆRHETEN -->
    <section class="section panel">
      <div class="title underline underline-red">
        <span class="ico">🧑‍🤝‍🧑</span> Personer i nærheten
      </div>
      <div id="nearbyPeople"></div>
    </section>

    <!-- MIN SAMLING -->
    <section class="section panel">
      <div class="title underline underline-gold">
        <span class="ico">📦</span> Min samling (<span id="collectionCount">0</span>)
      </div>
      <div id="collectionGrid" class="grid"></div>
      <div class="row right">
        <button id="btnMoreCollection" class="ghost-btn" style="display:none">+ flere</button>
      </div>
    </section>

    <!-- MERKER -->
    <section class="section panel">
      <div class="title underline underline-soft">
        <span class="ico">🏷️</span> Merker
      </div>
      <div id="merits" class="grid"></div>
    </section>

    <!-- GALLERI (SAMLEDE PERSONER) -->
    <section class="section panel">
      <div class="title underline underline-purple">
        <span class="ico">🖼️</span> Galleri (personer)
      </div>
      <div id="gallery"></div>
    </section>
  </main>

  <!-- PLACE INFO-CARD -->
  <div id="placeCard" aria-hidden="true">
    <div class="pc-head">
      <div>
        <div id="pcTitle" class="pc-title">Tittel</div>
        <div id="pcMeta" class="pc-meta">Kategori • radius</div>
      </div>
      <button id="pcClose" class="pc-close" aria-label="Lukk">✕</button>
    </div>
    <div id="pcDesc" class="pc-desc">Beskrivelse…</div>
    <div class="pc-actions">
      <a id="pcMore" class="ghost-btn" target="_blank" rel="noopener">Mer info</a>
      <button id="pcUnlock" class="primary-btn">Lås opp</button>
    </div>
  </div>

  <!-- SHEET: Se flere i nærheten -->
  <div id="sheetNearby" class="sheet" aria-hidden="true">
    <div class="sheet-card">
      <div class="sheet-head">
        <div class="sheet-title"><span class="ico">📍</span> Flere i nærheten</div>
        <button data-close="#sheetNearby" class="sheet-close">✕</button>
      </div>
      <div id="sheetNearbyBody"></div>
    </div>
  </div>

  <!-- SHEET: Flere i samlingen -->
  <div id="sheetCollection" class="sheet" aria-hidden="true">
    <div class="sheet-card">
      <div class="sheet-head">
        <div class="sheet-title"><span class="ico">📦</span> Samlingen din</div>
        <button data-close="#sheetCollection" class="sheet-close">✕</button>
      </div>
      <div id="sheetCollectionBody" class="grid"></div>
    </div>
  </div>

  <!-- QUIZ MODAL -->
  <div id="quizModal" aria-hidden="true" role="dialog" aria-label="Quiz">
    <div class="quiz-card">
      <div class="quiz-head">
        <div class="quiz-title" id="quizTitle">Quiz</div>
        <button class="quiz-close" id="quizClose" aria-label="Lukk">✕</button>
      </div>
      <div class="quiz-body">
        <div id="quizQuestion" class="quiz-q">…</div>
        <div id="quizChoices" class="quiz-choices"></div>
        <div id="quizProgress" class="quiz-progress"></div>
        <div id="quizFeedback" class="quiz-feedback"></div>
      </div>
    </div>
  </div>

  <script defer src="app.js"></script>
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('./sw.js').catch(()=>{});
    }
  </script>
</body>
</html>
